name: job-init
description: Job Init Action

runs:
  using: composite
  steps:
    - name: Abort if we are building for public
      if: github.event.repository.private
      shell: bash -l -eo pipefail {0}
      run: |
        echo "building private repo test"
        exit 1

    - name: Copy profile
      shell: bash -l -eo pipefail {0}
      # env:
      #   CICD_MIGRATION_SLACK_WEBHOOK_URL_B64: ${{ secret.CICD_MIGRATION_SLACK_WEBHOOK_URL }}
      run: |
        cp ${GITHUB_ACTION_PATH}/.bash_profile ${HOME}/.bash_profile
        # echo "export CICD_MIGRATION_SLACK_WEBHOOK_URL=$(echo ${CICD_MIGRATION_SLACK_WEBHOOK_URL_B64} | base64 -d)" >> ${HOME}/.bash_profile
        # echo "HAWK_WORKFLOW_ID=${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}" >> ${GITHUB_ENV}

    - id: init
      shell: bash -l -eo pipefail {0}
      run: hawk.job-init

    - name: Simulate running a step against prechecks
      id: precheck
      shell: bash -l -eo pipefail {0}
      run: hawk.runner-prechecks